<!DOCTYPE html>
<head>
	<title>Game</title>

	<link href="assets/css/reset.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<link href="assets/css/style.css" rel="stylesheet" type="text/css">
	<script src="assets/javascript/game.js"></script>

</head>
<body>


	<header>
		<h1>Star Wars RPG</h1>
	</header>

	<div id="instructions"></div>

	<div id="fighterSelect"></div>

	<div id="defenderArea"></div>
	<div id="outputArea"></div>
	<button id="fightBtn" class="btn btn-primary fight" value="fight"><h1>fight</h1></button>

    <div id="outputLog"></div>


	<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
		
	<script type="text/javascript">

		//global declarations
		var fighters = [];
		var player;
		var opponent;
		var playerSelected = false;
		var opponentSelected = false;
		var wins = 0;

		//initializing fighters
		var jarjar = Object.create(fighter);
		jarjar.initialize("Jar Jar Binks", 1000, 5, 2);

		var luke = Object.create(fighter);
		luke.initialize("Luke Skywalker", 100, 10, 20);

		var vader = Object.create(fighter);
		vader.initialize("Darth Vader", 150, 999, 10);

		var obiwan = Object.create(fighter);
		obiwan.initialize("Obi Wan Kenobi", 100, 50, 5);

		//feeding them into the array
		fighters.push(jarjar);
		fighters.push(luke);
		fighters.push(vader);
		fighters.push(obiwan);

		//building buttons
		for (var i = 0; i < fighters.length; i++) {
			var b = $("<button>");
			b.addClass("fighter-button fighter");
			
			b.attr("data-name", fighters[i].name);
			b.html(fighters[i].name); //this is HTML
			$("#fighterSelect").append(b);
		}

		//initializing
		hideFightBtn();
		writeInstructions("pick a fighter");

		$( document ).ready(function() {

			$('.fighter-button').on('click', function() {
				for (var i = 0; i < fighters.length; i++) {
					if(fighters[i].name == $(this).data('name') ) {
						if (playerSelected == false) {
							player = fighters[i];
							playerSelected = true;
							$(this).hide();
							writeInstructions("pick an opponent");
						} else {
							opponent = fighters[i];
							opponentSelected = true;
							$(this).hide();
							hideFighters();
							showFightBtn();
							writeInstructions("fight it out!");

						}

					}
				} 

			});

			
			$('.fight').on('click', function() {
				
				player.fight(opponent);

				if(player.isAlive() == false) {
					alert("You're dead! Refresh the game and try again");
					hideFightBtn();
				}
				else if(opponent.isAlive() == false) {
					++wins;
					opponentSelected = false;
					hideFightBtn();
					showFighters();

					if (wins + 1 == fighters.length) {
						alert("WINNER!");
					}
					else {
						writeInstructions("you've won. Pick another opponent");
					}

				}


			});



		});


		function showFightBtn() {
			var btn = $('#fightBtn');
			btn.show();
		}

		function hideFightBtn() {
			var btn = $('#fightBtn');
			btn.hide();
		}

		function hideFighters() {
			var btn = $('#fighterSelect')
			btn.hide();
		}

		function showFighters() {
			var btn = $('#fighterSelect')
			btn.show();
		}

		function writeInstructions(words) {
			$("#instructions").html(words);
		}




	</script>



</body>